let e=null,t=null,r=null;chrome.runtime.onMessage.addListener((a,u,l)=>(a.action==="startSearch"?(e&&clearInterval(e),chrome.tabs.query({active:!0,currentWindow:!0},h=>{h.length>0&&(t=h[0].id,r=a.name,e=setInterval(()=>{chrome.tabs.query({active:!0,currentWindow:!0},c=>{if(c.length>0&&c[0].id===t){const i=c[0].id;chrome.tabs.sendMessage(i,{action:"searchFriend",name:a.name},n=>{var s;(s=n==null?void 0:n.found)!=null&&s&&(clearInterval(e),e=null,t=null,chrome.storage.sync.set({isSearching:!1,activeTabId:null,searchName:""}),chrome.runtime.sendMessage({action:"searchStopped",activeTabId:i}),chrome.tabs.sendMessage(i,{message:"showAlert",content:`Found session with player named "${n==null?void 0:n.found}!"`}))})}})},a.speed),l({isSearching:!0,activeTabId:t}))})):a.action==="stopSearch"?(e&&(clearInterval(e),e=null,t=null,r=null),chrome.storage.sync.set({isSearching:!1,activeTabId:null}),l({isSearching:!1})):a.action==="status"&&l({isSearching:!!e,activeTabId:t,searchName:r}),!0));chrome.tabs.onRemoved.addListener((a,u)=>{a===t&&e&&(clearInterval(e),e=null,t=null,r=null,chrome.storage.sync.set({isSearching:!1}))});
